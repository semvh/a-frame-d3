<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>A-frame and D3</title>
    <meta name="description" content="A-frame and D3">

    <!-- A-frame -->
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>

    <!-- Fixed D3 -->
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <!-- D3 multi selection -->
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <style>
        body {
            margin: 0;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>

</head>

<body>
    <a-scene>

        <!-- Camera -->

        <a-entity position="0 1.5 0">
            <a-entity camera="" look-controls="" wasd-controls="">
                <a-cursor color="#FFF"></a-cursor>
            </a-entity>
        </a-entity>

        <!-- Box (not used) -->

        <!-- <a-box position="1.5 0 -5" scale="1" color="teal"></a-box> -->


        <a-sky color="#f1f1f1"></a-sky>
    </a-scene>

    <script>
        d3.csv("data.csv", function(error, data) {

            // console.log(data);

            var hscale = d3.scaleLinear()
                .domain([0, d3.max(data)])
                .range([0, 5])

            var scene = d3
                .select("a-scene");

            // Empty Array that loads the data from the CSV

            var dataAmount = [];

            for(i=0; i<parseInt(data[0].aantalMannen); i++){
                dataAmount.push(0);
            }
            // for(i=0; i<parseInt(data[0].aantalVrouwen); i++){
            //     dataAmount.push(1);
            // }

            var boxes = scene
                .selectAll("a-box.bar")
                .data(dataAmount)
                .enter()
                .append("a-box")
                .classed("bar", true)

                // New attrs
                .attrs({
                    position: function(d, i) {

                        if(d==0) {
                            // Man
                            var radius = 30;
                            var theta = (-i/150) * (2 * Math.PI)

                            var x = radius * Math.cos(theta);
                            var y = 0;
                            var z = radius * Math.sin(theta);
                            return x + " " + y + " " + z;
                        }
                    },

                    rotation: function(d,i) {
                      var x = 0;
                      var y = -360 * -i/150;
                      var z = 0;
                      return x + " " + y + " " + z
                    },

                    height: function(d, i) {
                        if(d==0) {
                            // Man
                            return 2;
                        }
                        else if(d==1) {
                            // Woman
                            return 2;
                        }
                    },

                    color: function(d,i){

                        if(d==0) {
                            // Man
                            return "#5278e9";
                        }
                        else if(d==1) {
                            // Woman
                            return "#f453da";
                        }
                    }
                })
        });
    </script>
</body>

</html>
