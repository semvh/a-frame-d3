<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tweede Kamer</title>
    <meta name="description" content="Een datavisualisatie voor de verkiezingen">

    <script src="build/js/aframe.min.js"></script> <!-- Local A-frame -->
    <script src="build/js/d3.min.js"></script> <!-- Local D3 -->
    <script src="build/js/d3-selection-multi.v1.min.js"></script> <!-- Local D3 multi selection -->

    <style>
        body { margin: 0; position: fixed; top: 0; right: 0; bottom: 0; left: 0; }
    </style>

    <script type="text/javascript">
        // Component to change to random color on click.
        AFRAME.registerComponent('laptop-cl', {
            init: function () {
                var elem = document.getElementById("changecamera");
                var state = "ground";

                this.el.addEventListener('click', function (evt) {
                    if (state == "air") {
                        elem.setAttribute('position', "0 1.8 -1");
                        elem.setAttribute('rotation', "0 -180 0");
                        state = "ground";
                    } else {
                        elem.setAttribute('position', "0 19 -1");
                        elem.setAttribute('rotation', "-50 -180 0");
                        state = "air";
                    }
                    // console.log('I was clicked at: ', evt.detail.intersection.point);
                });
            }
        });

        // Component to change to random color on click.
        AFRAME.registerComponent('cl-1998', {
            init: function () {
                this.el.addEventListener('click', function (evt) {
                    // Hier de functie
                });
            }
        });
    </script>
</head>

<body>
    <a-scene>
        <!-- Assets loader -->
        <a-assets>
            <a-asset-item id="person" src="build/3d-assets/3Dboy.obj"></a-asset-item>
            <img id="carpetTexture" src="build/img/carpet.jpg">
            <img id="wallTexture" src="build/img/wall.png">
            <!-- <video id="verkiezingen" src="build/video/verkiezingen.mp4"> -->

            <a-mixin id="wall" material="color: #ffffff; src: #wallTexture; repeat: 3 3;"></a-mixin>
            <a-mixin id="ceiling" material="color: #000458; src: #wallTexture; repeat: 8 8;"></a-mixin>
            <a-mixin id="floor" material="color: #dfdfdf; src: #carpetTexture; repeat: 30 30;"></a-mixin>
            <a-mixin id="person" obj-model="obj: #person;" position="0 0 5"></a-mixin>
        </a-assets>

        <!-- Camera -->
        <a-entity id="changecamera" position="0 1.70 -1" rotation="0 -180 0">
            <a-entity camera="" look-controls="" wasd-controls="fly: false; acceleration: 50; easing: 10;">
                <a-entity position="0 0 -0.1" geometry="primitive: ring; radiusOuter: 0.030; radiusInner: 0.020;" material="color: black; shader: flat; opacity: 0.5;" cursor="maxDistance: 30; fuse: true">
                    <a-animation begin="click" easing="ease-in" attribute="scale" fill="backwards" from="0.1 0.1 0.1" to="0.05 0.05 0.05" dur="150"></a-animation>
                    <a-animation begin="fusing" easing="ease-in" attribute="scale" fill="forwards" from="0.05 0.05 0.05" to="0.1 0.1 0.1" dur="1500"></a-animation>
                </a-entity>
            </a-entity>
        </a-entity>

        <a-entity mixin="person"></a-entity>

        <!-- Buttons -->


        <a-box cl-1998 position="9 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="9 6 19" rotation="0 180 0" text="align: center; width: 12; value: 1998;"></a-entity>
        <a-box cl-2002 position="6 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="6 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2002;"></a-entity>
        <a-box cl-2003 position="3 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="3 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2003;"></a-entity>
        <a-box cl-2006 position="0 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="0 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2006;"></a-entity>
        <a-box cl-2010 position="-3 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="-3 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2010;"></a-entity>
        <a-box cl-2012 position="-6 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="-6 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2012;"></a-entity>
        <a-box cl-2016 position="-9 8 19" scale="2 2 2" rotation="0 0 0" color="#ff0000"></a-box>
        <a-entity position="-9 6 19" rotation="0 180 0" text="align: center; width: 12; value: 2016;"></a-entity>

        <!-- Table -->
        <a-entity>
            <a-box position="1.24 0.5 0" scale="3 1 1" rotation="0 20 0" color="rgb(171, 114, 16)"></a-box>
            <a-box position="-1.24 0.5 0" scale="3 1 1" rotation="0 -20 0" color="rgb(171, 114, 16)"></a-box>
        </a-entity>

        <!-- Laptop -->
        <a-entity laptop-cl>
            <a-box position="0 1.025 0.4" scale="0.7 0.05 0.5" rotation="0 0 0" color="gray"></a-box>

            <a-entity position="0 1.25 0.65" rotation="9 0 0">

                <a-box  scale="0.7 0.05 0.5" color="gray" rotation="90 0 0"></a-box>
                <a-video src="#verkiezingen" width="0.65" height="0.4" position="0 0.025 -0.026" rotation="0 180 0"></a-video>

            </a-entity>

            <a-box position="0.300 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.240 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.180 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.120 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.060 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.0 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.060 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.120 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.180 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.240 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.300 1.05 0.50" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="0.300 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.240 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.180 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.120 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.060 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.0 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.060 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.120 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.180 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.240 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.300 1.05 0.44" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="0.300 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.240 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.180 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.120 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.060 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.0 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.060 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.120 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.180 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.240 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.300 1.05 0.38" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="0.300 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.240 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.180 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.120 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.060 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.0 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.060 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.120 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.180 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.240 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.300 1.05 0.32" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="0.300 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="0.240 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="0.0875 1.05 0.26" scale="0.23 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <a-box position="-0.060 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.120 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.180 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.240 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>
            <a-box position="-0.300 1.05 0.26" scale="0.05 0.01 0.05" rotation="0 0 0" color="#f1f1f1"></a-box>

            <!-- Laptop comes forward -->
            <!-- <a-animation begin="mouseenter"  attribute="position" to="0 0 -0.2" direction="alternate" dur="500" repeat="0"></a-animation> -->
        </a-entity>

        <!-- Room -->
        <a-entity class="room">
            <!-- Floor -->
            <a-plane mixin="floor" position="0 0 5" height="30" width="40" rotation="-90 0 0"></a-plane>

            <!-- Ceiling -->
            <a-plane mixin="ceiling" position="0 10 5" height="30" width="40" rotation="90 0 0"></a-plane>

            <a-plane mixin="wall" position="0 5 20" height="10" width="40" rotation="0 -180 0"></a-plane>
            <a-plane mixin="wall" position="0 5 -10" height="10" width="40" rotation="0 0 0"></a-plane>

            <a-plane mixin="wall" position="20 5 5" height="10" width="30" rotation="0 -90 0"></a-plane>
            <a-plane mixin="wall" position="-20 5 5" height="10" width="30" rotation="0 90 0"></a-plane>

            <!-- Default lighting injected by A-Frame. -->
            <a-entity light="type: ambient; color: #BBB" position="0 5 -5"></a-entity>
            <a-entity light="type: directional; color: #FFF; intensity: 0.5" position="-3 5 0"></a-entity>
            <a-entity light="type: directional; color: #FFF; intensity: 0.5" position="3 5 0"></a-entity>
        </a-entity>

        <a-sky color="#afafaf"></a-sky>
    </a-scene>

    <script>
        d3.csv("data.csv", function(error, data) { // Load datasheet
            // Global vars
            var rowAdd = 1.5, // Aantal dat per rij wordt toegevoegd
                radiusAdd = 1.5; // Hoeveelheid die wordt toegevoegd

            // Person vars
            var personX = 0,
                personCounter = 0;
                personHeight = 0.3,
                personBaseRadius = 10;

            // Cube vars
            var cubeX = 0,
                cubeCounter = 0;
                cubeHeight = 0.1,
                cubeBaseRadius = 10;

            // Colors
            var colors = ["#ffcc00","#e1b600","#f39200","#ce7c00","#e94c0a","#b23d02","#af0e80","#82045e","#0058b8","#163a72","#00a1cd","#0581a2","#53a31d","#488225","#afcb05","#899d0c"];

            // Empty Array that loads the data from the CSV
            var dataAmount = [];
            for(i=0; i<parseInt(data[7].age1825); i++){ dataAmount.push(0); }
            for(i=0; i<parseInt(data[7].age2545); i++){ dataAmount.push(1); }
            for(i=0; i<parseInt(data[7].age4565); i++){ dataAmount.push(2); }
            for(i=0; i<parseInt(data[7].age65plus); i++){ dataAmount.push(3); }

            var scene = d3.select("a-scene");
            var person = scene
                .selectAll("a-entity#person")
                .data(dataAmount)
                .enter()
                .append("a-entity")
                .classed("person", true)
                .attrs({ // New attrs
                    "mixin": "person",
                    position: function(d, i) {
                        var radius = personBaseRadius;
                        var theta = (personX / 72) * (2 * Math.PI);
                        personCounter++;
                        if (personCounter > 5) { personCounter = 0; } // Reset counter after each row;

                        switch (personCounter) {
                            case 1: case 2: case 3: case 4: case 5:
                                radius = personBaseRadius + (radiusAdd * personCounter);
                                y = personHeight * personCounter; break;
                            case 0:
                                radius = personBaseRadius+(radiusAdd*6);
                                y = personHeight*6;
                                personX += rowAdd; break; // Move one to the side
                        }

                        x = radius * Math.cos(theta);
                        z = radius * Math.sin(theta);

                        return x + " " + y + " " + z;
                    },
                    rotation: function(d,i) {
                        var x = 0;
                        var y = (180 * -i/150) + 90;
                        var z = 0;

                        return x + " " + y + " " + z
                    },
                    material: function(d, i) {
                        switch (d) {
                            case 0: return "color:" + colors[0]; break;
                            case 1: return "color:" + colors[6]; break;
                            case 2: return "color:" + colors[8]; break;
                            case 3: return "color:" + colors[12]; break;
                        }
                    }
                });
            var boxes = scene
                .selectAll("a-box.seat")
                .data(dataAmount)
                .enter()
                .append("a-box")
                .classed("seat", true)
                .attrs({ // New attrs
                    position: function(d, i) {
                        var radius = cubeBaseRadius;
                        var theta = (cubeX / 72) * (2 * Math.PI);
                        cubeCounter++;
                        if (cubeCounter > 5) { cubeCounter = 0; } // Reset counter after each row;

                        switch (cubeCounter) {
                            case 1: case 2: case 3: case 4: case 5:
                                y = cubeHeight * cubeCounter;
                                radius = cubeBaseRadius + (radiusAdd * cubeCounter); break;
                            case 0:
                                y = cubeHeight * 6;
                                radius = cubeBaseRadius + (radiusAdd * 6);
                                cubeX += rowAdd; break; // Move one to the side
                        }

                        x = radius * Math.cos(theta);
                        z = radius * Math.sin(theta);

                        return x + " " + y + " " + z;
                    },
                    rotation: function(d,i) {
                        var x = 0;
                        var y = 180 * -i/144;
                        var z = 0;

                        return x + " " + y + " " + z
                    },
                    height: function(d, i) {
                        var newHeight, height = 0.4;
                        cubeCounter++;
                        if (cubeCounter > 5) { cubeCounter = 0; } // Reset counter after each row;

                        switch (cubeCounter) {
                            case 1: case 2: case 3: case 4: case 5: newHeight = height * cubeCounter; break;
                            case 0: newHeight = height * 6; cubeX += rowAdd; break;
                        }

                        return newHeight;
                    },
                    material: function(d,i){
                        switch (d) {
                            case 0: return "color:" + colors[1]; break;
                            case 1: return "color:" + colors[7]; break;
                            case 2: return "color:" + colors[9]; break;
                            case 3: return "color:" + colors[13]; break;
                        }
                    }
                })
        });
    </script>
</body>
</html>
