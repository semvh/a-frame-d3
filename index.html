<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Tweede Kamer</title>
    <meta name="description" content="Een datavisualisatie voor de verkiezingen">

    <!-- A-frame -->
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>

    <!-- Fixed D3 -->
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <!-- D3 multi selection -->
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <style>
        body {
            margin: 0;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>

</head>

<body>
    <a-scene>
        <!-- Assets are here -->

        <a-assets>
            <img id="woodTexture" src="build/img/wood.jpg">
            <img id="carpetTexture" src="build/img/carpet.jpg">
        </a-assets>

        <!-- Camera -->

        <a-entity position="0 1.5 -3.5">
            <a-entity camera="" look-controls="" wasd-controls="">
                <a-cursor color="#FFF"></a-cursor>
            </a-entity>
        </a-entity>


        <!-- <a-entity obj-model="obj: #chair-obj; mtl: #chair-mtl" scale="0.0001"></a-entity> -->

        <!-- Box (not used) -->
        <a-entity>
            <a-box src="#woodTexture" position="-1.24 0 -4.25" scale="3 1 1" rotation="0 20 0" color="rgb(171, 114, 16)"></a-box>
            <a-box src="#woodTexture" position="1.24 0 -4.25" scale="3 1 1" rotation="0 -20 0" color="rgb(171, 114, 16)"></a-box>
        </a-entity>

        <!-- <a-plane src="#carpetTexture" position="0 -0.5 -7" height="25" width="40" rotation="-90 0 0" color="#cbffb9"></a-plane> -->
        <a-entity geometry="primitive: plane; width: 40; height: 25;" material="src: #carpetTexture; repeat: 10 10; color: #a2f2c9;" position="0 -0.5 -7" rotation="-90 0 0"></a-entity>

        <!-- Default lighting injected by A-Frame. -->
        <a-entity light="type: ambient; color: #BBB"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 0.5" position="3.5 5 1"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 0.5" position="3 5 1"></a-entity>


        <a-sky color="#ffffff"></a-sky>
    </a-scene>


    <script>

        // Global vars
        var rowHeight = 0,
            rowAddition = 2.5,
            baseRadius = 13,
            addRadius = 1.5;


        // Load datasheet
        d3.csv("data.csv", function(error, data) {
            // Empty Array that loads the data from the CSV
            var dataAmount = [];

            for(i=0; i<parseInt(data[0].aantalVrouwen); i++){
                dataAmount.push(1);
            }

            for(i=0; i<parseInt(data[0].aantalMannen); i++){
                dataAmount.push(0);
            }

            var hscale = d3.scaleLinear()
                .domain([0, d3.max(data)])
                .range([0, 5])

            var scene = d3
                .select("a-scene");

            var rowHeight = 0; // The var that stores the hight

            var rowAddition = .5; // How much higher the next row will be


            var boxes = scene
                .selectAll("a-box.bar")
                .data(dataAmount)
                .enter()
                .append("a-box")
                .classed("bar", true)
                .attrs({ // New attrs
                    position: function(d, i) {
                        if (i >= 0 && i <= 29) {
                            var radius = baseRadius;
                            var theta = (-i / 60) * (2 * Math.PI)
                            var y = rowHeight;
                        } else if (i > 29 && i <= 59) {
                            var radius = baseRadius + addRadius;
                            var theta = (i / 60) * (2 * Math.PI)
                            var y = rowHeight + rowAddition;
                        } else if (i > 59 && i <= 89) {
                            var radius = baseRadius + (addRadius*2);
                            var theta = (-i / 60) * (2 * Math.PI)
                            var y = rowHeight + (rowAddition*2);
                        } else if (i > 89 && i <= 119) {
                            var radius = baseRadius + (addRadius*3);
                            var theta = (i / 60) * (2 * Math.PI)
                            var y = rowHeight + (rowAddition*3);
                        } else if (i > 119 && i <= 149) {
                            var radius = baseRadius + (addRadius*4);
                            var theta = (-i / 60) * (2 * Math.PI)
                            var y = rowHeight + (rowAddition*4);
                        } else { var x = 0, y = 10, z = 0; }

                            var x = radius * Math.cos(theta);
                            var z = radius * Math.sin(theta);

                            return x + " " + y + " " + z;
                    },

                    rotation: function(d,i) {

                        if (i >= 0 && i <= 29) {
                            var y = -360 * -i / 60;
                        } else if (i > 29 && i <= 59) {
                            var y = 360 * -i / 60;
                        } else if (i > 59 && i <= 89) {
                            var y = -360 * -i / 60;
                        } else if (i > 89 && i <= 119) {
                            var y = 360 * -i / 60;
                        } else if (i > 119 && i <= 149) {
                            var y = -360 * -i / 60;
                        } else {
                            y = 10;
                        }

                        var x = 0, z = 0;
                        return x + " " + y + " " + z;
                    },

                    height: function(d, i) {
                        return 1;
                    },

                    color: function(d,i){
                        if (d==1) {
                            return "red";
                        } else if (d==0) {
                            return "blue";
                        }
                    },

                    src: "#carpetTexture"
                })
        });
    </script>
</body>

</html>
